å®Œæ•´æ•°ç»„æ–¹æ³•ï¼š [javascriptæ ¸å¿ƒè¯­æ³•->æ•°ç»„](https://github.com/zyileven/articles/blob/master/Javascript/%E6%A0%B8%E5%BF%83%E8%AF%AD%E6%B3%95/%E6%95%B0%E7%BB%84/%E6%95%B0%E7%BB%84.md)

## Arrayæ„é€ å™¨

Arrayæ„é€ å™¨ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨å¯¹è±¡å­—é¢é‡åˆ›å»ºæ•°ç»„ï¼Œè¿™æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œä½†æ˜¯æ€»æœ‰å¯¹è±¡å­—é¢é‡ä¹åŠ›çš„æ—¶å€™ï¼Œæ¯”å¦‚è¯´ï¼Œæˆ‘æƒ³åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸º8çš„ç©ºæ•°ç»„ã€‚è¯·æ¯”è¾ƒå¦‚ä¸‹ä¸¤ç§æ–¹å¼ï¼š

```
// ä½¿ç”¨Arrayæ„é€ å™¨
var a = Array(8); // [undefined Ã— 8]
// ä½¿ç”¨å¯¹è±¡å­—é¢é‡
var b = [];
b.length = 8; // [undefined Ã— 8]
```

Arrayæ„é€ å™¨æ˜æ˜¾è¦ç®€æ´ä¸€äº›ï¼Œè€Œä¸”ç›´æ¥ä½¿ç”¨Array(8)ä¸ä½¿ç”¨new Array(8)æ˜¯ä¸€æ ·çš„ã€‚

```JavaScript
function Array(){
  // å¦‚æœthisä¸æ˜¯Arrayçš„å®ä¾‹ï¼Œé‚£å°±é‡æ–°newä¸€ä¸ªå®ä¾‹
  if(!(this instanceof arguments.callee)){
    return new arguments.callee();
  }
}
```

Arrayæ„é€ å™¨æ ¹æ®å‚æ•°é•¿åº¦çš„ä¸åŒï¼Œæœ‰å¦‚ä¸‹ä¸¤ç§ä¸åŒçš„å¤„ç†ï¼š

- new Array(arg1, arg2,â€¦)ï¼Œå‚æ•°é•¿åº¦ä¸º0æˆ–é•¿åº¦å¤§äºç­‰äº2æ—¶ï¼Œä¼ å…¥çš„å‚æ•°å°†æŒ‰ç…§é¡ºåºä¾æ¬¡æˆä¸ºæ–°æ•°ç»„çš„ç¬¬0è‡³Né¡¹ï¼ˆå‚æ•°é•¿åº¦ä¸º0æ—¶ï¼Œè¿”å›ç©ºæ•°ç»„ï¼‰ã€‚
- new Array(len)ï¼Œå½“lenä¸æ˜¯æ•°å€¼æ—¶ï¼Œå¤„ç†åŒä¸Šï¼Œè¿”å›ä¸€ä¸ªåªåŒ…å«lenå…ƒç´ ä¸€é¡¹çš„æ•°ç»„ï¼›å½“lenä¸ºæ•°å€¼æ—¶ï¼Œæ ¹æ®å¦‚ä¸‹[è§„èŒƒ](http://ecma262-5.com/ELS5_HTML.htm#Section_15.4.2.2)ï¼Œlenæœ€å¤§ä¸èƒ½è¶…è¿‡32ä½æ— ç¬¦å·æ•´å‹ï¼Œå³éœ€è¦å°äº2çš„32æ¬¡æ–¹ï¼ˆlenæœ€å¤§ä¸º`Math.pow(2,32) -1`æˆ–`-1>>>0`ï¼‰ï¼Œå¦åˆ™å°†æŠ›å‡ºRangeErrorã€‚

## ES6æ–°å¢çš„æ„é€ å‡½æ•°æ–¹æ³•

é‰´äºæ•°ç»„çš„å¸¸ç”¨æ€§ï¼ŒES6ä¸“é—¨æ‰©å±•äº†æ•°ç»„æ„é€ å™¨`Array`Â ï¼Œæ–°å¢2ä¸ªæ–¹æ³•ï¼š`Array.of`ã€`Array.from`ã€‚

#### Array.of(ES6)

Array.ofç”¨äºå°†å‚æ•°ä¾æ¬¡è½¬åŒ–ä¸ºæ•°ç»„ä¸­çš„ä¸€é¡¹ï¼Œç„¶åè¿”å›è¿™ä¸ªæ–°æ•°ç»„ï¼Œè€Œä¸ç®¡è¿™ä¸ªå‚æ•°æ˜¯æ•°å­—è¿˜æ˜¯å…¶å®ƒã€‚

å®ƒåŸºæœ¬ä¸Šä¸Arrayæ„é€ å™¨åŠŸèƒ½ä¸€è‡´ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±åœ¨å•ä¸ªæ•°å­—å‚æ•°çš„å¤„ç†ä¸Šã€‚ å¦‚ä¸‹ï¼š

```javascript
Array.of(8.0); // [8]
Array(8.0); // [undefined Ã— 8]
```

å‚æ•°ä¸ºå¤šä¸ªï¼Œæˆ–å•ä¸ªå‚æ•°ä¸æ˜¯æ•°å­—æ—¶ï¼ŒArray.of ä¸ Arrayæ„é€ å™¨ç­‰åŒã€‚

```javascript
Array.of(8.0, 5); // [8, 5]
Array(8.0, 5); // [8, 5]

Array.of('8'); // ["8"]
Array('8'); // ["8"]
```

**polyfill** 

å¦‚ä¸‹ï¼š

```javascript
if (!Array.of){
  Array.of = function(){
    return Array.prototype.slice.call(arguments);
  };
}
```

#### Array.from(ES6)

Array.fromçš„è®¾è®¡åˆè¡·æ˜¯å¿«é€Ÿä¾¿æ·çš„åŸºäºå…¶ä»–å¯¹è±¡åˆ›å»ºæ–°æ•°ç»„ï¼Œå‡†ç¡®æ¥è¯´å°±æ˜¯**ä»ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯è¿­ä»£å¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„å®ä¾‹**ï¼Œ åªè¦ä¸€ä¸ªå¯¹è±¡æœ‰è¿­ä»£å™¨ï¼ŒArray.fromå°±èƒ½æŠŠå®ƒå˜æˆä¸€ä¸ªæ•°ç»„ï¼ˆå½“ç„¶ï¼Œæ˜¯è¿”å›æ–°çš„æ•°ç»„ï¼Œä¸æ”¹å˜åŸå¯¹è±¡ï¼‰ã€‚ 

è¯­æ³•ï¼š*Array.from(arrayLike[, processingFn[, thisArg]])* 

ä»è¯­æ³•ä¸Šçœ‹ï¼ŒArray.fromæ‹¥æœ‰3ä¸ªå½¢å‚ï¼Œç¬¬ä¸€ä¸ªä¸ºç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œå¿…é€‰ã€‚ç¬¬äºŒä¸ªä¸ºåŠ å·¥å‡½æ•°ï¼Œæ–°ç”Ÿæˆçš„æ•°ç»„ä¼šç»è¿‡è¯¥å‡½æ•°çš„åŠ å·¥å†è¿”å›ã€‚ç¬¬ä¸‰ä¸ªä¸ºthisä½œç”¨åŸŸï¼Œè¡¨ç¤ºåŠ å·¥å‡½æ•°æ‰§è¡Œæ—¶thisçš„å€¼ã€‚åä¸¤ä¸ªå‚æ•°éƒ½æ˜¯å¯é€‰çš„ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹ç”¨æ³•ã€‚

```javascript
var obj = {0: 'a', 1: 'b', 2:'c', length: 3};
Array.from(obj, function(value, index){
  console.log(value, index, this, arguments.length);
  return value.repeat(3); //å¿…é¡»æŒ‡å®šè¿”å›å€¼ï¼Œå¦åˆ™è¿”å›undefined
}, obj);
```

åŠ å·¥å‡½æ•°çš„thisä½œç”¨åŸŸè¢«objå¯¹è±¡å–ä»£ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°åŠ å·¥å‡½æ•°é»˜è®¤æ‹¥æœ‰ä¸¤ä¸ªå½¢å‚ï¼Œåˆ†åˆ«ä¸ºè¿­ä»£å™¨å½“å‰å…ƒç´ çš„å€¼å’Œå…¶ç´¢å¼•ã€‚ 

> æ³¨æ„ï¼Œä¸€æ—¦ä½¿ç”¨åŠ å·¥å‡½æ•°ï¼Œå¿…é¡»æ˜ç¡®æŒ‡å®šè¿”å›å€¼ï¼Œå¦åˆ™å°†éšå¼è¿”å›undefinedï¼Œæœ€ç»ˆç”Ÿæˆçš„æ•°ç»„ä¹Ÿä¼šå˜æˆä¸€ä¸ªåªåŒ…å«è‹¥å¹²ä¸ªundefinedå…ƒç´ çš„ç©ºæ•°ç»„ã€‚ 

å®é™…ä¸Šï¼Œå¦‚æœä¸éœ€è¦æŒ‡å®šthisï¼ŒåŠ å·¥å‡½æ•°å®Œå…¨å¯ä»¥æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°ã€‚ä¸Šè¿°ä»£ç å¯ä»¥ç®€åŒ–å¦‚ä¸‹ï¼š 

```
Array.from(obj, (value) => value.repeat(3)); 
```

é™¤äº†ä¸Šè¿°objå¯¹è±¡ä»¥å¤–ï¼Œæ‹¥æœ‰è¿­ä»£å™¨çš„å¯¹è±¡è¿˜åŒ…æ‹¬è¿™äº›ï¼š`String`ï¼Œ`Set`ï¼Œ`Map`ï¼Œ`arguments`ç­‰ï¼ŒArray.fromç»Ÿç»Ÿå¯ä»¥å¤„ç†ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š 

```JavaScript
// String
Array.from('abc'); // ["a", "b", "c"]
// Set
Array.from(new Set(['abc', 'def'])); // ["abc", "def"]
// Map
Array.from(new Map([[1, 'abc'], [2, 'def']])); // [[1, 'abc'], [2, 'def']]
// å¤©ç”Ÿçš„ç±»æ•°ç»„å¯¹è±¡arguments
function fn(){
    return Array.from(arguments);
}
fn(1, 2, 3); // [1, 2, 3]
```

è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„æ‰©å±•åœºæ™¯å¿…é¡»æä¸‹ã€‚æ¯”å¦‚è¯´ç”Ÿæˆä¸€ä¸ªä»0åˆ°æŒ‡å®šæ•°å­—çš„æ–°æ•°ç»„ï¼ŒArray.fromå°±å¯ä»¥è½»æ˜“çš„åšåˆ°ã€‚

```JavaScript
Array.from({length: 10}, (v, i) => i); // [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
```

åé¢æˆ‘ä»¬å°†ä¼šçœ‹åˆ°ï¼Œåˆ©ç”¨æ•°ç»„çš„keysæ–¹æ³•å®ç°ä¸Šè¿°åŠŸèƒ½ï¼Œå¯èƒ½è¿˜è¦ç®€å•ä¸€äº›ã€‚

### Array.isArray

Array.isArrayç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå˜é‡æ˜¯å¦æ•°ç»„ç±»å‹ã€‚JSçš„å¼±ç±»å‹æœºåˆ¶å¯¼è‡´åˆ¤æ–­å˜é‡ç±»å‹æ˜¯åˆçº§å‰ç«¯å¼€å‘è€…é¢è¯•æ—¶çš„å¿…è€ƒé¢˜ï¼Œä¸€èˆ¬æˆ‘éƒ½ä¼šå°†å…¶ä½œä¸ºè€ƒå¯Ÿå€™é€‰äººç¬¬ä¸€é¢˜ï¼Œç„¶ååŸºäºæ­¤å±•å¼€ã€‚åœ¨ES5æä¾›è¯¥æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬è‡³å°‘æœ‰å¦‚ä¸‹5ç§æ–¹å¼å»åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦æ•°ç»„ï¼š 

```JavaScript
var a = [];
// 1.åŸºäºinstanceof
a instanceof Array;
// 2.åŸºäºconstructor
a.constructor === Array;
// 3.åŸºäºObject.prototype.isPrototypeOf
Array.prototype.isPrototypeOf(a);
// 4.åŸºäºgetPrototypeOf
Object.getPrototypeOf(a) === Array.prototype;
// 5.åŸºäºObject.prototype.toString
Object.prototype.toString.apply(a) === '[object Array]';
```

ä»¥ä¸Šï¼Œé™¤äº†`Object.prototype.toString`å¤–ï¼Œå…¶å®ƒæ–¹æ³•éƒ½ä¸èƒ½æ­£ç¡®åˆ¤æ–­å˜é‡çš„ç±»å‹ã€‚

è¦çŸ¥é“ï¼Œä»£ç çš„è¿è¡Œç¯å¢ƒååˆ†å¤æ‚ï¼Œä¸€ä¸ªå˜é‡å¯èƒ½ä½¿ç”¨æµ‘èº«è§£æ•°å»è¿·æƒ‘å®ƒçš„åˆ›é€ è€…ã€‚ä¸”çœ‹ï¼š

```JavaScript
var a = {
    __proto__: Array.prototype
};
// åˆ†åˆ«åœ¨æ§åˆ¶å°è¯•è¿è¡Œä»¥ä¸‹ä»£ç 
// 1.åŸºäºinstanceof
a instanceof Array; // true
// 2.åŸºäºconstructor
a.constructor === Array; // true
// 3.åŸºäºObject.prototype.isPrototypeOf
Array.prototype.isPrototypeOf(a); // true
// 4.åŸºäºgetPrototypeOf
Object.getPrototypeOf(a) === Array.prototype; // true
```

ä»¥ä¸Šï¼Œ4ç§æ–¹æ³•å°†å…¨éƒ¨è¿”å›`true`ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬åªæ˜¯æ‰‹åŠ¨æŒ‡å®šäº†æŸä¸ªå¯¹è±¡çš„`__proto__`å±æ€§ä¸º`Array.prototype`ï¼Œä¾¿å¯¼è‡´äº†è¯¥å¯¹è±¡ç»§æ‰¿äº†Arrayå¯¹è±¡ï¼Œè¿™ç§æ¯«ä¸è´Ÿè´£ä»»çš„ç»§æ‰¿æ–¹å¼ï¼Œä½¿å¾—åŸºäºç»§æ‰¿çš„åˆ¤æ–­æ–¹æ¡ˆç¬é—´åœŸå´©ç“¦è§£ã€‚ 

ä¸ä»…å¦‚æ­¤ï¼Œæˆ‘ä»¬è¿˜çŸ¥é“ï¼ŒArrayæ˜¯å †æ•°æ®ï¼Œå˜é‡æŒ‡å‘çš„åªæ˜¯å®ƒçš„å¼•ç”¨åœ°å€ï¼Œå› æ­¤æ¯ä¸ªé¡µé¢çš„Arrayå¯¹è±¡å¼•ç”¨çš„åœ°å€éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚iframeä¸­å£°æ˜çš„æ•°ç»„ï¼Œå®ƒçš„æ„é€ å‡½æ•°æ˜¯iframeä¸­çš„Arrayå¯¹è±¡ã€‚å¦‚æœåœ¨iframeå£°æ˜äº†ä¸€ä¸ªæ•°ç»„`x`ï¼Œå°†å…¶èµ‹å€¼ç»™çˆ¶é¡µé¢çš„å˜é‡`y`ï¼Œé‚£ä¹ˆåœ¨çˆ¶é¡µé¢ä½¿ç”¨`y instanceof Array`Â ï¼Œç»“æœä¸€å®šæ˜¯`false`çš„ã€‚ è€Œæœ€åä¸€ç§è¿”å›çš„æ˜¯å­—ç¬¦ä¸²ï¼Œä¸ä¼šå­˜åœ¨å¼•ç”¨é—®é¢˜ã€‚å®é™…ä¸Šï¼Œå¤šé¡µé¢æˆ–ç³»ç»Ÿä¹‹é—´çš„äº¤äº’åªæœ‰å­—ç¬¦ä¸²èƒ½å¤Ÿç•…è¡Œæ— é˜»ã€‚ 

ä½¿ç”¨Array.isArrayåˆ™éå¸¸ç®€å•ï¼Œå¦‚ä¸‹ï¼š 

```JavaScript
Array.isArray([]); // true
Array.isArray({0: 'a', length: 1}); // false
```

é€šè¿‡`Object.prototype.toString`å»åˆ¤æ–­ä¸€ä¸ªå€¼çš„ç±»å‹ï¼Œä¹Ÿæ˜¯å„å¤§ä¸»æµåº“çš„æ ‡å‡†ã€‚å› æ­¤Array.isArrayçš„polyfillé€šå¸¸é•¿è¿™æ ·ï¼š 

```JavaScript
if (!Array.isArray){
    Array.isArray = function(arg){
        return Object.prototype.toString.call(arg) === '[object Array]';
    };
}
```

### åŸå‹

ç»§æ‰¿çš„å¸¸è¯†å‘Šè¯‰æˆ‘ä»¬ï¼Œjsä¸­æ‰€æœ‰çš„æ•°ç»„æ–¹æ³•å‡æ¥è‡ªäºArray.prototypeï¼Œå’Œå…¶ä»–æ„é€ å‡½æ•°ä¸€æ ·ï¼Œä½ å¯ä»¥é€šè¿‡æ‰©å±• `Array` çš„ `prototype` å±æ€§ä¸Šçš„æ–¹æ³•æ¥ç»™æ‰€æœ‰æ•°ç»„å®ä¾‹å¢åŠ æ–¹æ³•ã€‚

å€¼å¾—ä¸€è¯´çš„æ˜¯ï¼ŒArray.prototypeæœ¬èº«å°±æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚

```JavaScript
Array.isArray(Array.prototype); // true
console.log(Array.prototype.length);// 0
```

ä»¥ä¸‹æ–¹æ³•å¯ä»¥è¿›ä¸€æ­¥éªŒè¯ï¼š

```JavaScript
console.log([].__proto__.length);// 0
console.log([].__proto__);// []
```

### æ•°ç»„æ–¹æ³•

æ•°ç»„åŸå‹æä¾›çš„æ–¹æ³•éå¸¸ä¹‹å¤šï¼Œä¸»è¦åˆ†ä¸ºä¸‰ç§ï¼Œ**ä¸€ç§æ˜¯ä¼šæ”¹å˜è‡ªèº«å€¼çš„ï¼Œä¸€ç§æ˜¯ä¸ä¼šæ”¹å˜è‡ªèº«å€¼çš„ï¼Œå¦å¤–ä¸€ç§æ˜¯éå†æ–¹æ³•ã€‚** 

ç”±äº Array.prototype çš„æŸäº›å±æ€§è¢«è®¾ç½®ä¸º[[DontEnum]]ï¼Œå› æ­¤ä¸èƒ½ç”¨ä¸€èˆ¬çš„æ–¹æ³•è¿›è¡Œéå†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è·å– Array.prototype çš„æ‰€æœ‰æ–¹æ³•ï¼š 

```JavaScript
let res=Object.getOwnPropertyNames(Array.prototype); // ["length", "constructor", "toString", "toLocaleString", "join", "pop", "push", "reverse", "shift", "unshift", "slice", "splice", "sort", "filter", "forEach", "some", "every", "map", "indexOf", "lastIndexOf", "reduce", "reduceRight", "copyWithin", "find", "findIndex", "fill", "includes", "entries", "keys", "concat"]
console.log(res);
```

#### æ”¹å˜è‡ªèº«å€¼çš„æ–¹æ³•(ES6)

åŸºäºES6ï¼Œæ”¹å˜è‡ªèº«å€¼çš„æ–¹æ³•ä¸€å…±æœ‰9ä¸ªï¼Œåˆ†åˆ«ä¸ºpopã€pushã€reverseã€shiftã€sortã€spliceã€unshiftï¼Œä»¥åŠä¸¤ä¸ªES6æ–°å¢çš„æ–¹æ³•copyWithin å’Œ fillã€‚ 

å¯¹äºèƒ½æ”¹å˜è‡ªèº«å€¼çš„æ•°ç»„æ–¹æ³•ï¼Œæ—¥å¸¸å¼€å‘ä¸­éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼Œå°½é‡é¿å…åœ¨å¾ªç¯éå†ä¸­å»æ”¹å˜åŸæ•°ç»„çš„é¡¹ã€‚ 

##### copyWithinï¼ˆES6ï¼‰

copyWithin() æ–¹æ³•åŸºäº**ECMAScript 2015ï¼ˆES6ï¼‰è§„èŒƒ**ï¼Œç”¨äºæ•°ç»„å†…å…ƒç´ ä¹‹é—´çš„æ›¿æ¢ï¼Œå³æ›¿æ¢å…ƒç´ å’Œè¢«æ›¿æ¢å…ƒç´ å‡æ˜¯æ•°ç»„å†…çš„å…ƒç´ ã€‚

è¯­æ³•ï¼š*arr.copyWithin(target, start[, end = this.length])*

taget æŒ‡å®šè¢«æ›¿æ¢å…ƒç´ çš„ç´¢å¼•ï¼Œstart æŒ‡å®šæ›¿æ¢å…ƒç´ èµ·å§‹çš„ç´¢å¼•ï¼Œend å¯é€‰ï¼ŒæŒ‡çš„æ˜¯æ›¿æ¢å…ƒç´ ç»“æŸä½ç½®çš„ç´¢å¼•ã€‚

å¦‚æœstartä¸ºè´Ÿï¼Œåˆ™å…¶æŒ‡å®šçš„ç´¢å¼•ä½ç½®ç­‰åŒäºlength+startï¼Œlengthä¸ºæ•°ç»„çš„é•¿åº¦ã€‚endä¹Ÿæ˜¯å¦‚æ­¤ã€‚ 

```JavaScript
var array = [1,2,3,4,5]; 
var array2 = array.copyWithin(0,3);// å°†3-ï¼ˆlength-1ï¼‰çš„æ›¿æ¢å…ƒç´ æ’å…¥åˆ°0ä½ç½®
console.log(array===array2,array2); // true [4, 5, 3, 4, 5]

var array = [1,2,3,4,5]; 
console.log(array.copyWithin(0,3,4)); // [4, 2, 3, 4, 5]å°†3-4çš„æ›¿æ¢å…ƒç´ æ’å…¥åœ¨0ä½ç½®

var array = [1,2,3,4,5]; 
console.log(array.copyWithin(0,-2,-1)); // [4, 2, 3, 4, 5] å°†ï¼ˆlength-3ï¼‰-ï¼ˆlength-1ï¼‰çš„æ›¿æ¢å…ƒç´ æ’å…¥åˆ°0ä½ç½®ã€‚
```

åŒä¸Šï¼ŒcopyWithinä¸€æ ·å—ç›Šäºé¸­å¼è¾¨å‹ï¼Œä¾‹å¦‚ï¼š

```JavaScript
var o = {0:1, 1:2, 2:3, 3:4, 4:5,length:5}
var o2 = Array.prototype.copyWithin.call(o,0,3);
console.log(o===o2,o2); // true Object { 0=4,  1=5,  2=3,  æ›´å¤š...}
```

**Ployfill**

```JavaScript
if (!Array.prototype.copyWithin) {
    Array.prototype.copyWithin = function(target, start/*, end*/) {
        // Steps 1-2.
        if (this == null) {
            throw new TypeError('this is null or not defined');
        }

        var O = Object(this);

        // Steps 3-5.
        var len = O.length >>> 0;

        // Steps 6-8.
        var relativeTarget = target >> 0;

        var to = relativeTarget < 0 ?
            Math.max(len + relativeTarget, 0) :
            Math.min(relativeTarget, len);

        // Steps 9-11.
        var relativeStart = start >> 0;

        var from = relativeStart < 0 ?
            Math.max(len + relativeStart, 0) :
            Math.min(relativeStart, len);

        // Steps 12-14.
        var end = arguments[2];
        var relativeEnd = end === undefined ? len : end >> 0;

        var final = relativeEnd < 0 ?
            Math.max(len + relativeEnd, 0) :
            Math.min(relativeEnd, len);

        // Step 15.
        var count = Math.min(final - from, len - to);

        // Steps 16-17.
        var direction = 1;

        if (from < to && to < (from + count)) {
            direction = -1;
            from += count - 1;
            to += count - 1;
        }

        // Step 18.
        while (count > 0) {
            if (from in O) {
                O[to] = O[from];
            } else {
                delete O[to];
            }

            from += direction;
            to += direction;
            count--;
        }

        // Step 19.
        return O;
    };
}
```

##### fillï¼ˆES6ï¼‰

fill() æ–¹æ³•åŸºäº**ECMAScript 2015ï¼ˆES6ï¼‰è§„èŒƒ**ï¼Œå®ƒåŒæ ·ç”¨äºæ•°ç»„å…ƒç´ æ›¿æ¢ï¼Œä½†ä¸copyWithinç•¥æœ‰ä¸åŒï¼Œå®ƒä¸»è¦ç”¨äºå°†æ•°ç»„æŒ‡å®šåŒºé—´å†…çš„å…ƒç´ æ›¿æ¢ä¸ºæŸä¸ªå€¼ã€‚

è¯­æ³•ï¼š*arr.fill(value, start[, end = this.length])*

value æŒ‡å®šè¢«æ›¿æ¢çš„å€¼ï¼Œstart æŒ‡å®šæ›¿æ¢å…ƒç´ èµ·å§‹çš„ç´¢å¼•ï¼Œend å¯é€‰ï¼ŒæŒ‡çš„æ˜¯æ›¿æ¢å…ƒç´ ç»“æŸä½ç½®çš„ç´¢å¼•ã€‚

å¦‚æœstartä¸ºè´Ÿï¼Œåˆ™å…¶æŒ‡å®šçš„ç´¢å¼•ä½ç½®ç­‰åŒäºlength+startï¼Œlengthä¸ºæ•°ç»„çš„é•¿åº¦ã€‚endä¹Ÿæ˜¯å¦‚æ­¤ã€‚

```JavaScript
[1, 2, 3].fill(4);               // [4, 4, 4]
[1, 2, 3].fill(4, 1);            // [1, 4, 4]
[1, 2, 3].fill(4, 1, 2);         // [1, 4, 3]
[1, 2, 3].fill(4, 1, 1);         // [1, 2, 3]
[1, 2, 3].fill(4, 3, 3);         // [1, 2, 3]
[1, 2, 3].fill(4, -3, -2);       // [4, 2, 3]
[1, 2, 3].fill(4, NaN, NaN);     // [1, 2, 3]
[1, 2, 3].fill(4, 3, 5);         // [1, 2, 3]
Array(3).fill(4);                // [4, 4, 4]
[].fill.call({ length: 3 }, 4);  // {0: 4, 1: 4, 2: 4, length: 3}

// Objects by reference.
var arr = Array(3).fill({}) // [{}, {}, {}];
arr[0].hi = "hi"; // [{ hi: "hi" }, { hi: "hi" }, { hi: "hi" }]
```

åŒä¸Šï¼Œfill ä¸€æ ·å—ç›Šäºé¸­å¼è¾¨å‹ï¼Œä¾‹å¦‚ï¼š

```JavaScript
var o = {0:1, 1:2, 2:3, 3:4, 4:5,length:5}
var o2 = Array.prototype.fill.call(o,10,0,2);
console.log(o===o2,o2); true Object { 0=10,  1=10,  2=3,  æ›´å¤š...}
```

**Polyfill**

```JavaScript
if (!Array.prototype.fill) {
  Object.defineProperty(Array.prototype, 'fill', {
    value: function(value) {

      // Steps 1-2.
      if (this == null) {
        throw new TypeError('this is null or not defined');
      }

      var O = Object(this);

      // Steps 3-5.
      var len = O.length >>> 0;

      // Steps 6-7.
      var start = arguments[1];
      var relativeStart = start >> 0;

      // Step 8.
      var k = relativeStart < 0 ?
        Math.max(len + relativeStart, 0) :
        Math.min(relativeStart, len);

      // Steps 9-10.
      var end = arguments[2];
      var relativeEnd = end === undefined ?
        len : end >> 0;

      // Step 11.
      var final = relativeEnd < 0 ?
        Math.max(len + relativeEnd, 0) :
        Math.min(relativeEnd, len);

      // Step 12.
      while (k < final) {
        O[k] = value;
        k++;
      }

      // Step 13.
      return O;
    }
  });
}
```

#### ä¸æ”¹å˜è‡ªèº«çš„æ–¹æ³•(ES6)

åŸºäºES7ï¼Œä¸ä¼šæ”¹å˜è‡ªèº«çš„æ–¹æ³•ä¸€å…±æœ‰9ä¸ªï¼Œåˆ†åˆ«ä¸ºconcatã€joinã€sliceã€toStringã€toLocateStringã€indexOfã€lastIndexOfã€æœªæ ‡å‡†çš„toSourceä»¥åŠES7æ–°å¢çš„æ–¹æ³•includesã€‚ 

##### includes(ES6)

includes() æ–¹æ³•åŸºäº**ECMAScript 2016ï¼ˆES7ï¼‰è§„èŒƒ**ï¼Œå®ƒç”¨æ¥åˆ¤æ–­å½“å‰æ•°ç»„æ˜¯å¦åŒ…å«æŸä¸ªæŒ‡å®šçš„å€¼ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚

è¯­æ³•ï¼š*arr.includes(element, fromIndex=0)*

element ä¸ºéœ€è¦æŸ¥æ‰¾çš„å…ƒç´ ã€‚

fromIndex è¡¨ç¤ºä»è¯¥ç´¢å¼•ä½ç½®å¼€å§‹æŸ¥æ‰¾ elementï¼Œç¼ºçœä¸º0ï¼Œå®ƒæ˜¯æ­£å‘æŸ¥æ‰¾ï¼Œå³ä»ç´¢å¼•å¤„å¾€æ•°ç»„æœ«å°¾æŸ¥æ‰¾ã€‚

```JavaScript
var array = [-0, 1, 2];
console.log(array.includes(+0)); // true
console.log(array.includes(1)); // true
console.log(array.includes(2,-4)); // true
```

ä½ å¯èƒ½ä¼šé—®ï¼Œæ—¢ç„¶æœ‰äº†indexOfæ–¹æ³•ï¼Œä¸ºä»€ä¹ˆåˆé€ ä¸€ä¸ªincludesæ–¹æ³•ï¼Œ`arr.indexOf(x)>-1`ä¸å°±ç­‰äº`arr.includes(x)`ï¼Ÿçœ‹èµ·æ¥æ˜¯çš„ï¼Œå‡ ä¹æ‰€æœ‰çš„æ—¶å€™å®ƒä»¬éƒ½ç­‰åŒï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯includesèƒ½å¤Ÿå‘ç°NaNï¼Œè€ŒindexOfä¸èƒ½ ã€‚

```JavaScript
var array = [NaN];
console.log(array.includes(NaN)); // true
console.log(arra.indexOf(NaN)>-1); // false
```

è¯¥æ–¹æ³•åŒæ ·å—ç›Šäºé¸­å¼è¾¨å‹ã€‚å¦‚ä¸‹ï¼š

```JavaScript
var o = {0:'a', 1:'b', 2:'c', length:3};
var bool = Array.prototype.includes.call(o, 'a');
console.log(bool); // true
```

### éå†æ–¹æ³•

åŸºäºES6ï¼Œåˆ†åˆ«ä¸ºforEachã€everyã€someã€filterã€mapã€reduceã€reduceRight ä»¥åŠES6æ–°å¢çš„æ–¹æ³•entriesã€findã€findIndexã€keysã€valuesã€‚ 

##### entriesï¼ˆES6ï¼‰

entries() æ–¹æ³•åŸºäº**ECMAScript 2015ï¼ˆES6ï¼‰è§„èŒƒ**ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„è¿­ä»£å™¨å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«æ•°ç»„ä¸­æ¯ä¸ªç´¢å¼•çš„é”®å€¼å¯¹ã€‚

è¯­æ³•ï¼š*arr.entries()*

```JavaScript
var array = ["a", "b", "c"];
var iterator = array.entries();
console.log(iterator.next().value); // [0, "a"]
console.log(iterator.next().value); // [1, "b"]
console.log(iterator.next().value); // [2, "c"]
console.log(iterator.next().value); // undefined, è¿­ä»£å™¨å¤„äºæ•°ç»„æœ«å°¾æ—¶, å†è¿­ä»£å°±ä¼šè¿”å›undefined
```

å¾ˆæ˜æ˜¾ï¼Œentries ä¹Ÿå—ç›Šäºé¸­å¼è¾¨å‹ï¼Œå¦‚ä¸‹ï¼š

```JavaScript
var o = {0:"a", 1:"b", 2:"c", length:3};
var iterator = Array.prototype.entries.call(o);
console.log(iterator.next().value); // [0, "a"]
console.log(iterator.next().value); // [1, "b"]
console.log(iterator.next().value); // [2, "c"]
```

##### find&findIndexï¼ˆES6ï¼‰

find() æ–¹æ³•åŸºäº**ECMAScript 2015ï¼ˆES6ï¼‰è§„èŒƒ**ï¼Œè¿”å›æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Œ å¦‚æœæ²¡æœ‰ï¼Œåˆ™è¿”å›undefinedã€‚ 

findIndex() æ–¹æ³•ä¹ŸåŸºäº**ECMAScript 2015ï¼ˆES6ï¼‰è§„èŒƒ**ï¼Œå®ƒè¿”å›æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ çš„ç´¢å¼•ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰å¦åˆ™è¿”å›-1ã€‚ 

è¯­æ³•ï¼š*arr.find(fn, thisArg)*ï¼Œ*arr.findIndex(fn, thisArg)*

æˆ‘ä»¬å‘ç°å®ƒä»¬çš„è¯­æ³•ä¸forEachç­‰ååˆ†ç›¸ä¼¼ï¼Œå…¶å®ä¸å…‰è¯­æ³•ï¼Œfindï¼ˆæˆ–findIndexï¼‰åœ¨å‚æ•°åŠå…¶ä½¿ç”¨æ³¨æ„äº‹é¡¹ä¸Šï¼Œå‡ä¸forEachä¸€è‡´ã€‚å› æ­¤æ­¤å¤„å°†ç•¥å» findï¼ˆæˆ–findIndexï¼‰çš„å‚æ•°ä»‹ç»ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸ªä¾‹å­ğŸŒ° ï¼š

```JavaScript
var array = [1, 3, 5, 7, 8, 9, 10];
function f(value, index, array){
  return value%2==0; // è¿”å›å¶æ•°
}
function f2(value, index, array){
  return value > 20; // è¿”å›å¤§äº20çš„æ•°
}
console.log(array.find(f)); // 8
console.log(array.find(f2)); // undefined
console.log(array.findIndex(f)); // 4
console.log(array.findIndex(f2)); // -1
```

##### keys/valuesï¼ˆES6ï¼‰

keys() æ–¹æ³•åŸºäº**ECMAScript 2015ï¼ˆES6ï¼‰è§„èŒƒ**ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ç´¢å¼•çš„è¿­ä»£å™¨ã€‚ï¼ˆæµè§ˆå™¨å®é™…å®ç°å¯èƒ½ä¼šæœ‰è°ƒæ•´ï¼‰

è¯­æ³•ï¼š*arr.keys()*

```JavaScript
var array = ["abc", "xyz"];
var iterator = array.keys();
console.log(iterator.next()); // Object {value: 0, done: false}
console.log(iterator.next()); // Object {value: 1, done: false}
console.log(iterator.next()); // Object {value: undefined, done: false}
```

ç´¢å¼•è¿­ä»£å™¨ä¼šåŒ…å«é‚£äº›æ²¡æœ‰å¯¹åº”å…ƒç´ çš„ç´¢å¼•ï¼Œå¦‚ä¸‹ï¼š

```JavaScript
var array = ["abc", , "xyz"];
var sparseKeys = Object.keys(array);
var denseKeys = [...array.keys()];
console.log(sparseKeys); // ["0", "2"]
console.log(denseKeys);  // [0, 1, 2]
```

å‰é¢æˆ‘ä»¬ç”¨Array.fromç”Ÿæˆä¸€ä¸ªä»0åˆ°æŒ‡å®šæ•°å­—çš„æ–°æ•°ç»„ï¼Œåˆ©ç”¨keysä¹Ÿå¾ˆå®¹æ˜“å®ç°ã€‚

```javascript
[...Array(10).keys()]; // [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[...new Array(10).keys()]; // [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
```

ç”±äºArrayçš„ç‰¹æ€§ï¼Œnew Array å’Œ Array å¯¹å•ä¸ªæ•°å­—çš„å¤„ç†ç›¸åŒï¼Œå› æ­¤ä»¥ä¸Šä¸¤ç§å‡å¯è¡Œã€‚

values() æ–¹æ³•åŸºäº**ECMAScript 2015ï¼ˆES6ï¼‰è§„èŒƒ**ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„è¿­ä»£å™¨å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«æ•°ç»„ä¸­æ¯ä¸ªç´¢å¼•çš„å€¼ã€‚å…¶ç”¨æ³•åŸºæœ¬ä¸ä¸Šè¿° entries æ–¹æ³•ä¸€è‡´ã€‚

è¯­æ³•ï¼š*arr.values()*

```javascript
var array = ["abc", "xyz"];
var iterator = array.values();
console.log(iterator.next().value);//abc
console.log(iterator.next().value);//xyz
```

Symbol.iteratorï¼ˆï¼‰